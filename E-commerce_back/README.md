# å››äººåä½œç”µå•†é¡¹ç›® - ExpressæœåŠ¡å™¨

è¿™æ˜¯ä¸€ä¸ªåŸºäºExpress.jså’ŒMongoDBçš„ç”µå•†åç«¯APIæœåŠ¡å™¨ï¼Œä¸“ä¸ºå››äººåä½œå¼€å‘è®¾è®¡ã€‚

## ğŸš€ ç‰¹æ€§

- **å®Œæ•´çš„ç”µå•†åŠŸèƒ½**: ç”¨æˆ·ç®¡ç†ã€äº§å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€åˆ†ç±»ç®¡ç†
- **å®‰å…¨çš„è®¤è¯ç³»ç»Ÿ**: JWTä»¤ç‰Œè®¤è¯ï¼Œè§’è‰²æƒé™æ§åˆ¶
- **MongoDBé›†æˆ**: ä½¿ç”¨Mongoose ODMï¼Œæ”¯æŒäº‘æ•°æ®åº“
- **RESTful API**: æ ‡å‡†åŒ–çš„APIè®¾è®¡ï¼Œæ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰
- **è¾“å…¥éªŒè¯**: ä½¿ç”¨express-validatorè¿›è¡Œæ•°æ®éªŒè¯
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶
- **åä½œå‹å¥½**: æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œä¾¿äºå¤šäººåä½œå¼€å‘

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Node.js >= 16.0.0
- MongoDB >= 4.4
- npm æˆ– yarn

## ğŸ› ï¸ å®‰è£…æ­¥éª¤

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <é¡¹ç›®åœ°å€>
cd e-commerce-server
```

### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå‚è€ƒ `.env.example`ï¼‰ï¼š
```env
# MongoDBè¿æ¥é…ç½®
MONGODB_URI=mongodb+srv://3269779984:tangyaqi..@diyigejihe.df8avp1.mongodb.net/

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# JWTé…ç½®
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=7d

# å®‰å…¨é…ç½®
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

### 4. å¯åŠ¨æœåŠ¡å™¨
```bash
# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ database.js        # æ•°æ®åº“è¿æ¥é…ç½®
â”œâ”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ auth.js           # è®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ errorHandler.js   # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â””â”€â”€ notFound.js       # 404å¤„ç†ä¸­é—´ä»¶
â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ User.js          # ç”¨æˆ·æ¨¡å‹
â”‚   â”œâ”€â”€ Product.js       # äº§å“æ¨¡å‹
â”‚   â”œâ”€â”€ Order.js         # è®¢å•æ¨¡å‹
â”‚   â””â”€â”€ Category.js      # åˆ†ç±»æ¨¡å‹
â”œâ”€â”€ routes/               # è·¯ç”±
â”‚   â”œâ”€â”€ auth.js          # è®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ users.js         # ç”¨æˆ·ç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ products.js      # äº§å“ç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ orders.js        # è®¢å•ç®¡ç†è·¯ç”±
â”‚   â””â”€â”€ categories.js    # åˆ†ç±»ç®¡ç†è·¯ç”±
â”œâ”€â”€ uploads/              # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore           # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ package.json          # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ README.md            # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ server.js            # ä¸»æœåŠ¡å™¨æ–‡ä»¶
```

## ğŸ” APIè®¤è¯

### è·å–ä»¤ç‰Œ
```bash
POST /api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}
```

### ä½¿ç”¨ä»¤ç‰Œ
```bash
Authorization: Bearer <your-jwt-token>
```

## ğŸ“š APIç«¯ç‚¹

### è®¤è¯ç›¸å…³
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

### ç”¨æˆ·ç®¡ç†
- `GET /api/users` - è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/users/:id` - è·å–ç”¨æˆ·è¯¦æƒ…
- `PUT /api/users/:id` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `DELETE /api/users/:id` - åˆ é™¤ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
- `PATCH /api/users/:id/toggle-status` - åˆ‡æ¢ç”¨æˆ·çŠ¶æ€ï¼ˆç®¡ç†å‘˜ï¼‰

### äº§å“ç®¡ç†
- `GET /api/products` - è·å–äº§å“åˆ—è¡¨
- `GET /api/products/:id` - è·å–äº§å“è¯¦æƒ…
- `POST /api/products` - åˆ›å»ºäº§å“ï¼ˆç®¡ç†å‘˜ï¼‰
- `PUT /api/products/:id` - æ›´æ–°äº§å“ï¼ˆç®¡ç†å‘˜ï¼‰
- `DELETE /api/products/:id` - åˆ é™¤äº§å“ï¼ˆç®¡ç†å‘˜ï¼‰
- `POST /api/products/:id/reviews` - æ·»åŠ äº§å“è¯„è®º
- `GET /api/products/:id/reviews` - è·å–äº§å“è¯„è®º

### è®¢å•ç®¡ç†
- `GET /api/orders` - è·å–ç”¨æˆ·è®¢å•åˆ—è¡¨
- `GET /api/orders/admin` - è·å–æ‰€æœ‰è®¢å•ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/orders/:id` - è·å–è®¢å•è¯¦æƒ…
- `POST /api/orders` - åˆ›å»ºè®¢å•
- `PATCH /api/orders/:id/status` - æ›´æ–°è®¢å•çŠ¶æ€ï¼ˆç®¡ç†å‘˜ï¼‰
- `PATCH /api/orders/:id/cancel` - å–æ¶ˆè®¢å•
- `DELETE /api/orders/:id` - åˆ é™¤è®¢å•ï¼ˆç®¡ç†å‘˜ï¼‰

### åˆ†ç±»ç®¡ç†
- `GET /api/categories` - è·å–åˆ†ç±»æ ‘å½¢ç»“æ„
- `GET /api/categories/flat` - è·å–åˆ†ç±»å¹³é“ºåˆ—è¡¨
- `GET /api/categories/:id` - è·å–åˆ†ç±»è¯¦æƒ…
- `GET /api/categories/slug/:slug` - æ ¹æ®slugè·å–åˆ†ç±»
- `POST /api/categories` - åˆ›å»ºåˆ†ç±»ï¼ˆç®¡ç†å‘˜ï¼‰
- `PUT /api/categories/:id` - æ›´æ–°åˆ†ç±»ï¼ˆç®¡ç†å‘˜ï¼‰
- `DELETE /api/categories/:id` - åˆ é™¤åˆ†ç±»ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/categories/:id/products` - è·å–åˆ†ç±»ä¸‹çš„äº§å“
- `PATCH /api/categories/reorder` - æ‰¹é‡æ›´æ–°åˆ†ç±»æ’åºï¼ˆç®¡ç†å‘˜ï¼‰

## ğŸ”’ æƒé™æ§åˆ¶

### ç”¨æˆ·è§’è‰²
- **user**: æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥æµè§ˆäº§å“ã€ä¸‹å•ã€ç®¡ç†è‡ªå·±çš„è®¢å•
- **moderator**: ç‰ˆä¸»ï¼Œå¯ä»¥ç®¡ç†äº§å“è¯„è®ºã€ååŠ©ç®¡ç†
- **admin**: ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™

### æƒé™çŸ©é˜µ
| æ“ä½œ | user | moderator | admin |
|------|------|-----------|-------|
| æµè§ˆäº§å“ | âœ… | âœ… | âœ… |
| ä¸‹å• | âœ… | âœ… | âœ… |
| ç®¡ç†è‡ªå·±çš„è®¢å• | âœ… | âœ… | âœ… |
| æ·»åŠ è¯„è®º | âœ… | âœ… | âœ… |
| ç®¡ç†äº§å“ | âŒ | âŒ | âœ… |
| ç®¡ç†åˆ†ç±» | âŒ | âŒ | âœ… |
| ç®¡ç†ç”¨æˆ· | âŒ | âŒ | âœ… |
| ç®¡ç†æ‰€æœ‰è®¢å• | âŒ | âŒ | âœ… |

## ğŸš€ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ES6+è¯­æ³•
- éµå¾ªRESTful APIè®¾è®¡åŸåˆ™
- ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- å®Œæ•´çš„è¾“å…¥éªŒè¯
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### åä½œå¼€å‘æµç¨‹
1. **åŠŸèƒ½åˆ†æ”¯**: æ¯ä¸ªåŠŸèƒ½åˆ›å»ºç‹¬ç«‹åˆ†æ”¯
2. **ä»£ç å®¡æŸ¥**: æäº¤å‰è¿›è¡Œä»£ç å®¡æŸ¥
3. **æµ‹è¯•**: ç¡®ä¿APIåŠŸèƒ½æ­£å¸¸
4. **æ–‡æ¡£**: æ›´æ–°APIæ–‡æ¡£å’Œæ³¨é‡Š

### æ·»åŠ æ–°åŠŸèƒ½
1. åˆ›å»ºæ•°æ®æ¨¡å‹ï¼ˆå¦‚éœ€è¦ï¼‰
2. æ·»åŠ è·¯ç”±å¤„ç†
3. å®ç°ä¸šåŠ¡é€»è¾‘
4. æ·»åŠ æƒé™æ§åˆ¶
5. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
6. æ›´æ–°æ–‡æ¡£

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•å¹¶ç›‘å¬æ–‡ä»¶å˜åŒ–
npm run test:watch
```

## ğŸ“¦ éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒé…ç½®
```env
NODE_ENV=production
PORT=3000
MONGODB_URI=your-production-mongodb-uri
JWT_SECRET=your-production-jwt-secret
```

### PM2éƒ¨ç½²
```bash
npm install -g pm2
pm2 start server.js --name "ecommerce-api"
pm2 save
pm2 startup
```

## ğŸ”§ å¸¸è§é—®é¢˜

### MongoDBè¿æ¥å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- éªŒè¯è¿æ¥å­—ç¬¦ä¸²
- ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™

### JWTä»¤ç‰Œæ— æ•ˆ
- æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ
- éªŒè¯JWT_SECRETé…ç½®
- ç¡®è®¤ä»¤ç‰Œæ ¼å¼æ­£ç¡®

### æƒé™ä¸è¶³
- æ£€æŸ¥ç”¨æˆ·è§’è‰²
- éªŒè¯è·¯ç”±æƒé™è®¾ç½®
- ç¡®è®¤ä¸­é—´ä»¶é…ç½®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿæˆ–æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªåä½œå¼€å‘é¡¹ç›®ï¼Œè¯·éµå¾ªå›¢é˜Ÿå¼€å‘è§„èŒƒï¼Œä¿æŒè‰¯å¥½çš„ä»£ç è´¨é‡å’Œæ–‡æ¡£æ›´æ–°ã€‚ 